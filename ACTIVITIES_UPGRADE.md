# تحديث نظام الأنشطة المدرسية - دعم الوسائط المتعددة

## نظرة عامة
تم تطوير نظام الأنشطة المدرسية ليدعم رفع عدة صور وفيديوهات للنشاط الواحد، مع واجهة مستخدم محسنة وميزات متقدمة.

## الميزات الجديدة

### 1. رفع ملفات متعددة
- دعم رفع عدة صور وفيديوهات في نفس الوقت
- أنواع الملفات المدعومة: JPG, PNG, MP4, AVI, MOV
- معاينة الملفات قبل الرفع
- إمكانية حذف ملفات من القائمة قبل الإرسال

### 2. Drag & Drop
- سحب وإفلات الملفات مباشرة
- تأثيرات بصرية عند السحب
- دعم كامل للغة العربية

### 3. معاينة الملفات
- صور مصغرة للصور
- أيقونات للفيديوهات مع أسماء الملفات
- عرض حجم الملف ونوعه
- إمكانية حذف ملفات من القائمة

### 4. شريط التقدم
- عرض تقدم رفع الملفات
- رسائل حالة واضحة
- معالجة الأخطاء

### 5. إدارة الوسائط
- عرض جميع وسائط النشاط
- إعادة ترتيب الوسائط
- تحديد صورة رئيسية
- حذف وسائط فردية

### 6. معرض محسن
- عرض الصورة الرئيسية في البطاقة
- عداد عدد الوسائط الإضافية
- معرض منبثق لجميع الوسائط
- مشغل فيديو مدمج

## التحديثات التقنية

### قاعدة البيانات
- إضافة جدول `ActivityMedia` جديد
- علاقة one-to-many بين النشاط والوسائط
- دعم ترتيب العرض والصورة الرئيسية

### Backend
- Route جديد لرفع الملفات المتعددة
- معالجة وحفظ الملفات في مجلد منظم
- ضغط الصور تلقائياً
- إنشاء صور مصغرة للفيديوهات

### Frontend
- واجهة رفع ملفات أنيقة
- JavaScript محسن للتفاعلات
- دعم كامل للغة العربية
- تصميم responsive

## كيفية الاستخدام

### للمشرفين
1. **رفع نشاط جديد:**
   - املأ بيانات النشاط
   - اسحب وأفلت الملفات أو انقر لاختيارها
   - راجع معاينة الملفات
   - اضغط "رفع النشاط"

2. **إدارة الوسائط:**
   - انقر على "عرض جميع الوسائط" في أي نشاط
   - أعد ترتيب الوسائط بالسحب والإفلات
   - حدد صورة رئيسية
   - احذف وسائط غير مرغوبة

### للزوار
1. **تصفح الأنشطة:**
   - شاهد الصورة الرئيسية لكل نشاط
   - انقر على الصورة لعرضها بحجم كامل
   - انقر على "عرض المعرض" لرؤية جميع الوسائط

2. **مشاهدة الفيديوهات:**
   - انقر على أيقونة الفيديو
   - استخدم مشغل الفيديو المدمج
   - شارك الفيديو على وسائل التواصل

## ترقية قاعدة البيانات

إذا كان لديك بيانات قديمة، اتبع هذه الخطوات:

1. انتقل إلى صفحة إدارة الأنشطة
2. انقر على زر "ترقية قاعدة البيانات"
3. انتظر اكتمال العملية
4. تحقق من نقل البيانات بنجاح

## الملفات المحدثة

### Backend
- `app.py` - إضافة routes جديدة ونماذج قاعدة البيانات

### Frontend
- `templates/admin_activities.html` - واجهة إدارة الأنشطة
- `templates/activities_gallery.html` - معرض الأنشطة للزوار

### قاعدة البيانات
- `SchoolActivity` - نموذج محدث
- `ActivityMedia` - نموذج جديد

## الأمان والتحقق

- التحقق من أنواع الملفات
- تحديد حجم أقصى للملفات
- ضغط الصور تلقائياً
- حماية من XSS وCSRF
- تسجيل جميع العمليات

## الأداء

- ضغط الصور لتوفير المساحة
- تحميل تدريجي للمحتوى
- تخزين مؤقت للصور المصغرة
- تحسين استعلامات قاعدة البيانات

## الدعم

لأي استفسارات أو مشاكل:
- تحقق من سجلات الأخطاء
- تأكد من صلاحيات المجلدات
- تحقق من إعدادات الخادم

## التطوير المستقبلي

- دعم المزيد من أنواع الملفات
- تحميل مباشر من الكاميرا
- معالجة الفيديو في المتصفح
- مشاركة مباشرة على وسائل التواصل
- إحصائيات مفصلة للاستخدام
